PASS tests/listingStatusWorkflow.test.js
PASS src/tests/authApi.test.js
  ‚óè Console

    console.log
      DEBUG: Created role for user test: {
        created_at: 2025-08-15T16:53:09.017Z,
        updated_at: 2025-08-15T16:53:09.017Z,
        role_id: 4,
        name: 'user_role_450873',
        description: null
      } role_id: 4

      at Object.log (src/tests/authApi.test.js:203:15)

PASS tests/itemApi.test.js
  ‚óè Console

    console.error
      Error in createCatalog: Error: 
          at Query.run (F:\Dev\eBaySalesTool\backend\node_modules\sequelize\src\dialects\postgres\query.js:76:25)
          at F:\Dev\eBaySalesTool\backend\node_modules\sequelize\src\sequelize.js:650:28
          at processTicksAndRejections (node:internal/process/task_queues:95:5)
          at PostgresQueryInterface.insert (F:\Dev\eBaySalesTool\backend\node_modules\sequelize\src\dialects\abstract\query-interface.js:795:21)
          at model.save (F:\Dev\eBaySalesTool\backend\node_modules\sequelize\src\model.js:4154:35)
          at Function.create (F:\Dev\eBaySalesTool\backend\node_modules\sequelize\src\model.js:2305:12)
          at Object.<anonymous>.exports.createCatalog (F:\Dev\eBaySalesTool\backend\src\controllers\itemController.js:17:28) {
        name: 'SequelizeUniqueConstraintError',
        errors: [
          ValidationErrorItem {
            message: 'sku must be unique',
            type: 'unique violation',
            path: 'sku',
            value: 'SKU-DUPLICATE-TEST',
            origin: 'DB',
            instance: [catalog],
            validatorKey: 'not_unique',
            validatorName: null,
            validatorArgs: []
          }
        ],
        parent: error: duplicate key value violates unique constraint "catalog_sku_key"
            at Parser.parseErrorMessage (F:\Dev\eBaySalesTool\backend\node_modules\pg-protocol\src\parser.ts:369:69)
            at Parser.handlePacket (F:\Dev\eBaySalesTool\backend\node_modules\pg-protocol\src\parser.ts:187:21)
            at Parser.parse (F:\Dev\eBaySalesTool\backend\node_modules\pg-protocol\src\parser.ts:102:30)
            at Socket.<anonymous> (F:\Dev\eBaySalesTool\backend\node_modules\pg-protocol\src\index.ts:7:48)
            at Socket.emit (node:events:517:28)
            at addChunk (node:internal/streams/readable:368:12)
            at readableAddChunk (node:internal/streams/readable:341:9)
            at Socket.Readable.push (node:internal/streams/readable:278:10)
            at TCP.onStreamRead (node:internal/stream_base_commons:190:23) {
          length: 210,
          severity: 'ERROR',
          code: '23505',
          detail: 'Key (sku)=(SKU-DUPLICATE-TEST) already exists.',
          hint: undefined,
          position: undefined,
          internalPosition: undefined,
          internalQuery: undefined,
          where: undefined,
          schema: 'public',
          table: 'catalog',
          column: undefined,
          dataType: undefined,
          constraint: 'catalog_sku_key',
          file: 'nbtinsert.c',
          line: '664',
          routine: '_bt_check_unique',
          sql: 'INSERT INTO "catalog" ("item_id","description","manufacturer","model","sku","barcode","created_at","updated_at") VALUES (DEFAULT,$1,$2,$3,$4,$5,$6,$7) RETURNING "item_id","description","manufacturer","model","sku","barcode","created_at","updated_at";',
          parameters: [
            'Test Catalog 3',
            'TestCo',
            'T1000',
            'SKU-DUPLICATE-TEST',
            'SKU-DUPLICATE-TESTB',
            '2025-08-15 12:53:09.548 +00:00',
            '2025-08-15 12:53:09.548 +00:00'
          ]
        },
        original: error: duplicate key value violates unique constraint "catalog_sku_key"
            at Parser.parseErrorMessage (F:\Dev\eBaySalesTool\backend\node_modules\pg-protocol\src\parser.ts:369:69)
            at Parser.handlePacket (F:\Dev\eBaySalesTool\backend\node_modules\pg-protocol\src\parser.ts:187:21)
            at Parser.parse (F:\Dev\eBaySalesTool\backend\node_modules\pg-protocol\src\parser.ts:102:30)
            at Socket.<anonymous> (F:\Dev\eBaySalesTool\backend\node_modules\pg-protocol\src\index.ts:7:48)
            at Socket.emit (node:events:517:28)
            at addChunk (node:internal/streams/readable:368:12)
            at readableAddChunk (node:internal/streams/readable:341:9)
            at Socket.Readable.push (node:internal/streams/readable:278:10)
            at TCP.onStreamRead (node:internal/stream_base_commons:190:23) {
          length: 210,
          severity: 'ERROR',
          code: '23505',
          detail: 'Key (sku)=(SKU-DUPLICATE-TEST) already exists.',
          hint: undefined,
          position: undefined,
          internalPosition: undefined,
          internalQuery: undefined,
          where: undefined,
          schema: 'public',
          table: 'catalog',
          column: undefined,
          dataType: undefined,
          constraint: 'catalog_sku_key',
          file: 'nbtinsert.c',
          line: '664',
          routine: '_bt_check_unique',
          sql: 'INSERT INTO "catalog" ("item_id","description","manufacturer","model","sku","barcode","created_at","updated_at") VALUES (DEFAULT,$1,$2,$3,$4,$5,$6,$7) RETURNING "item_id","description","manufacturer","model","sku","barcode","created_at","updated_at";',
          parameters: [
            'Test Catalog 3',
            'TestCo',
            'T1000',
            'SKU-DUPLICATE-TEST',
            'SKU-DUPLICATE-TESTB',
            '2025-08-15 12:53:09.548 +00:00',
            '2025-08-15 12:53:09.548 +00:00'
          ]
        },
        fields: { sku: 'SKU-DUPLICATE-TEST' },
        sql: 'INSERT INTO "catalog" ("item_id","description","manufacturer","model","sku","barcode","created_at","updated_at") VALUES (DEFAULT,$1,$2,$3,$4,$5,$6,$7) RETURNING "item_id","description","manufacturer","model","sku","barcode","created_at","updated_at";'
      }

    [0m [90m 25 |[39m     } [36mcatch[39m (error) {
     [90m 26 |[39m         [90m// Hide raw error details from client and log server-side[39m
    [31m[1m>[22m[39m[90m 27 |[39m         console[33m.[39merror([32m'Error in createCatalog:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 28 |[39m         [36mif[39m (error[33m.[39mname [33m===[39m [32m'SequelizeUniqueConstraintError'[39m) {
     [90m 29 |[39m             [36mreturn[39m res[33m.[39mstatus([35m409[39m)[33m.[39mjson({ message[33m:[39m [32m'Duplicate SKU or Barcode'[39m })[33m;[39m
     [90m 30 |[39m         }[0m

      at error (src/controllers/itemController.js:27:17)

PASS tests/listingDetailsChangeHistory.test.js
PASS tests/listingApi.test.js
PASS tests/customerApi.test.js
PASS tests/historyEndpoint.test.js
PASS tests/ownershipApi.test.js
PASS tests/listingOwnershipHistory.test.js
PASS tests/listingDefaultStatusConfig.test.js
PASS tests/listingAudit.test.js
PASS tests/listingItemIdImmutable.test.js
PASS tests/ebayInfoApi.test.js
PASS tests/listingStatusDefault.test.js
PASS src/tests/customerApi.test.js
PASS tests/listingStatusWorkflowAdmin.test.js
PASS tests/entityConstants.test.js
PASS tests/auditLoggerNumericNormalization.test.js

Test Suites: 18 passed, 18 total
Tests:       72 passed, 72 total
Snapshots:   0 total
Time:        10.87 s
Ran all test suites matching /tests/i.
